<a class="skip-link" href="#main">Saltar al contenido</a>

<header class="site-header" [class.hide]="hidden" [class.at-top]="atTop" role="banner">
  <div class="container header-inner">
    <button class="nav-toggle" type="button" aria-label="Abrir menú" (click)="toggleDrawer()">
      <fluent-icon name="panel_left" [size]="24" iconStyle="regular"></fluent-icon>
    </button>
    <a class="brand" routerLink="/" aria-label="EcoLATAM - inicio">
      <img src="/ecolatam-logo.png" alt="{{ logoAlt }}" height="56" />
    </a>
    <span class="spacer"></span>
  </div>
</header>

<!-- Drawer lateral izquierdo (fuera del header para que el blur cubra toda la pantalla) -->
<div class="drawer-overlay" *ngIf="drawerOpen" (click)="closeDrawer()"></div>
<aside class="drawer" [class.open]="drawerOpen" aria-label="Menú principal" (click)="$event.stopPropagation()">
  <div class="drawer-header">
    <ng-container *ngIf="isLogged(); else guest">
      <div class="avatar"><img src="/avatar-placeholder.png" alt="avatar" /></div>
      <div class="who">
        <strong>{{ me()?.name || 'Usuario' }}</strong>
        <span class="muted">{{ me()?.email }}</span>
      </div>
    </ng-container>
    <ng-template #guest>
      <div class="auth-actions">
        <a routerLink="/login" class="btn-ghost">Iniciar sesión</a>
        <a routerLink="/register" class="btn">Crear cuenta</a>
      </div>
    </ng-template>
  </div>

  <nav class="drawer-nav">
    <div class="group">
      <p class="label">Explorar</p>
      <a routerLink="/ecoguia" (click)="closeDrawer()">
        <fluent-icon name="leaf_three" [size]="20" iconStyle="regular"></fluent-icon>
        <span>EcoGuía</span>
      </a>
      <a routerLink="/solutions" (click)="closeDrawer()">
        <fluent-icon name="lightbulb" [size]="20" iconStyle="regular"></fluent-icon>
        <span>Soluciones</span>
      </a>
      <a href="https://ipfs.ecolatam.com" target="_blank" rel="noopener">
        <fluent-icon name="cloud" [size]="20" iconStyle="regular"></fluent-icon>
        <span>Gateway IPFS</span>
      </a>
    </div>
    <div class="group">
      <p class="label">Sobre</p>
      <a routerLink="/about" (click)="closeDrawer()">
        <fluent-icon name="info" [size]="20" iconStyle="regular"></fluent-icon>
        <span>Nosotros</span>
      </a>
      <a routerLink="/contact" (click)="closeDrawer()">
        <fluent-icon name="mail" [size]="20" iconStyle="regular"></fluent-icon>
        <span>Contacto</span>
      </a>
      <a routerLink="/blog" (click)="closeDrawer()">
        <fluent-icon name="news" [size]="20" iconStyle="regular"></fluent-icon>
        <span>Blog</span>
      </a>
    </div>
    <div class="group" *ngIf="isLogged()">
      <p class="label">Cuenta</p>
      <a [routerLink]="['/users', me()?.id]" (click)="closeDrawer()">
        <fluent-icon name="person" [size]="20" iconStyle="regular"></fluent-icon>
        <span>Mi perfil</span>
      </a>
      <a (click)="logout()">
        <fluent-icon name="door" [size]="20" iconStyle="regular"></fluent-icon>
        <span>Cerrar sesión</span>
      </a>
    </div>
    <div class="group" *ngIf="!isLogged()">
      <p class="label">Acceso</p>
      <a routerLink="/login" (click)="closeDrawer()">
        <fluent-icon name="person_key" [size]="20" iconStyle="regular"></fluent-icon>
        <span>Iniciar sesión</span>
      </a>
      <a routerLink="/register" (click)="closeDrawer()">
        <fluent-icon name="person_accounts" [size]="20" iconStyle="regular"></fluent-icon>
        <span>Crear cuenta</span>
      </a>
    </div>
    <div class="group" *ngIf="isAdmin()">
      <p class="label">Admin</p>
      <a routerLink="/admin" (click)="closeDrawer()">
        <fluent-icon name="home" [size]="20" iconStyle="regular"></fluent-icon>
        <span>Dashboard</span>
      </a>
      <a routerLink="/admin/categories" (click)="closeDrawer()">
        <fluent-icon name="book" [size]="20" iconStyle="regular"></fluent-icon>
        <span>Categorías</span>
      </a>
      <a routerLink="/admin/catalogs" (click)="closeDrawer()">
        <fluent-icon name="database_lightning" [size]="20" iconStyle="regular"></fluent-icon>
        <span>Catálogos</span>
      </a>
    </div>
  </nav>
</aside>
